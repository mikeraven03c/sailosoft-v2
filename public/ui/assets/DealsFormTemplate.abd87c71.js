import{bk as $,w as h,E as G,r as J,a1 as s,a4 as u,a7 as l,a3 as n,af as e,a2 as N,bh as E,a0 as M,a8 as O,a9 as z,aB as c,_ as K,a5 as C,a6 as U,ac as T,aI as X}from"./index.74d7f585.js";import{Q,d as w}from"./format.08b9b864.js";import{Q as V}from"./QSelect.6e6a07ef.js";import{H as I,Q as Y,a as P,b as Z,c as q,_ as ee}from"./NoteIndexTemplate.17f07146.js";import{a as B,Q as R,_ as L}from"./FormModal.78f5b439.js";import{Q as oe}from"./QForm.b6b25a10.js";import{s as H}from"./selectRenderHooks.8e94ca0e.js";import{_ as le}from"./OrganizationFormTemplate.cb4f8620.js";import ae from"./ContactFormTemplate.e1f411c3.js";import"./touch.654b88c8.js";import"./ResourceForm.a3f7e177.js";import"./ContextMenu.5e794d2d.js";import"./QList.850a9c5c.js";import"./ClosePopup.f0cb9b11.js";import"./IndexManagement.70bc027e.js";import"./QSpace.19d9814e.js";const te={key:0,class:"q-ma-xl"},re={key:1,class:"q-gutter-md q-mt-xs"},ne={key:0,class:"q-ma-xl"},ie={key:1,class:"q-gutter-md q-mt-xs"},Ue={__name:"DealsFormTemplate",props:{formHooks:Object},setup(j){const{formHooks:D}=j,{formData:r,formReadonly:g,formError:i,hooksCycle:W,actions:A}=D,_=H({url:"custom-apps/contacts",map:a=>({label:a.name,value:a.id})}),S=H({url:"custom-apps/organizations",map:a=>({label:a.name,value:a.id})}),m=B({title:"Organization",url:"custom-apps/organizations"});m.hooksCycle.afterCreate=a=>{r.value.organization={label:a.name,value:a.id}},m.hooksCycle.afterUpdate=a=>{v.record.value=a};const p=B({title:$.title,url:$.url});p.hooksCycle.afterCreate=a=>{r.value.contact={label:a.name,value:a.id}},p.hooksCycle.afterUpdate=a=>{f.record.value=a};const x=H({url:"custom-apps/pipelines",map:a=>({label:a.name,value:a.id})}),k=H({url:"custom-apps/pipeline-stages",map:a=>({label:a.name,value:a.id})});k.hooks.resolvedParams=a=>(a.params["filter[pipeline_id]"]=r.value.pipeline.value,a);const f=I({url:"custom-apps/contacts"}),v=I({url:"custom-apps/organizations"});W.afterResolve=a=>(a.is_lead=!1,a.contact&&(a.contact_id=a.contact.value),a.organization&&(a.organization_id=a.organization.value),a),h(()=>r.value.pipeline,(a,o)=>{a&&(r.value.pipeline_stage=null)}),G(()=>{var a,o;A.formMode.isShow()&&(r.value.contact&&f.fetch((a=r.value.contact_id)!=null?a:r.value.contact.value),r.value.organization&&v.fetch((o=r.value.organization_id)!=null?o:r.value.organization.value))});const F=J("contact");return(a,o)=>(s(),u("div",null,[l(oe,{class:"q-gutter-md q-mt-xs"},{default:n(()=>[l(V,{filled:"","use-input":"",dense:"","hide-bottom-space":"",modelValue:e(r).contact,"onUpdate:modelValue":o[1]||(o[1]=t=>e(r).contact=t),"error-message":e(i).contact,error:e(i).contact!==void 0,label:"Contact","input-debounce":"1000",options:e(_).options.value,onFilter:e(_).filterFn,onFilterAbort:e(_).abortFilterFn,readonly:e(g),clearable:""},{append:n(()=>[e(r).contact?O("",!0):(s(),N(M,{key:0,class:"cursor-pointer",name:"add_circle",onClick:o[0]||(o[0]=E(t=>e(p).actions.form.create(),["stop","prevent"]))}))]),"no-option":n(()=>[l(Q,null,{default:n(()=>[l(w,{class:"text-grey"},{default:n(()=>[z(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","error-message","error","options","onFilter","onFilterAbort","readonly"]),l(V,{filled:"","use-input":"",dense:"","hide-bottom-space":"",modelValue:e(r).organization,"onUpdate:modelValue":o[3]||(o[3]=t=>e(r).organization=t),"error-message":e(i).organization,error:e(i).organization!==void 0,label:"Organization","input-debounce":"1000",options:e(S).options.value,onFilter:e(S).filterFn,onFilterAbort:e(S).abortFilterFn,readonly:e(g),clearable:""},{append:n(()=>[e(r).organization?O("",!0):(s(),N(M,{key:0,class:"cursor-pointer",name:"add_circle",onClick:o[2]||(o[2]=E(t=>e(m).actions.form.create(),["stop","prevent"]))}))]),"no-option":n(()=>[l(Q,null,{default:n(()=>[l(w,{class:"text-grey"},{default:n(()=>[z(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","error-message","error","options","onFilter","onFilterAbort","readonly"]),l(c,{modelValue:e(r).title,"onUpdate:modelValue":o[4]||(o[4]=t=>e(r).title=t),filled:"",label:"Title *",outlined:"","hide-bottom-space":"",dense:"",readonly:e(g),"error-message":e(i).title,error:e(i).title!==void 0},null,8,["modelValue","readonly","error-message","error"]),l(c,{modelValue:e(r).value,"onUpdate:modelValue":o[5]||(o[5]=t=>e(r).value=t),filled:"",label:"Value",outlined:"","hide-bottom-space":"",dense:"",readonly:e(g),"error-message":e(i).value,error:e(i).value!==void 0},null,8,["modelValue","readonly","error-message","error"]),l(V,{filled:"","use-input":"",dense:"","hide-bottom-space":"",modelValue:e(r).pipeline,"onUpdate:modelValue":o[6]||(o[6]=t=>e(r).pipeline=t),"error-message":e(i).pipeline,error:e(i).pipeline!==void 0,label:"Pipelines","input-debounce":"1000",options:e(x).options.value,onFilter:e(x).filterFn,onFilterAbort:e(x).abortFilterFn,readonly:e(g)},{"no-option":n(()=>[l(Q,null,{default:n(()=>[l(w,{class:"text-grey"},{default:n(()=>[z(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","error-message","error","options","onFilter","onFilterAbort","readonly"]),l(V,{filled:"","use-input":"",dense:"","hide-bottom-space":"",modelValue:e(r).pipeline_stage,"onUpdate:modelValue":o[7]||(o[7]=t=>e(r).pipeline_stage=t),"error-message":e(i).pipeline_stage,error:e(i).pipeline_stage!==void 0,label:"Pipeline Stage","input-debounce":"1000",options:e(k).options.value,onFilter:e(k).filterFn,onFilterAbort:e(k).abortFilterFn,readonly:e(g)},{"no-option":n(()=>[l(Q,null,{default:n(()=>[l(w,{class:"text-grey"},{default:n(()=>[z(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","error-message","error","options","onFilter","onFilterAbort","readonly"]),l(V,{modelValue:e(r).label,"onUpdate:modelValue":o[8]||(o[8]=t=>e(r).label=t),"error-message":e(i).label,error:e(i).label!==void 0,filled:"","hide-bottom-space":"",dense:"",options:["Hot","Warm","Cold"],label:"Label"},null,8,["modelValue","error-message","error"]),l(c,{modelValue:e(r).source,"onUpdate:modelValue":o[9]||(o[9]=t=>e(r).source=t),filled:"",label:"Source",outlined:"","hide-bottom-space":"",dense:"",readonly:e(g),"error-message":e(i).source,error:e(i).source!==void 0},null,8,["modelValue","readonly","error-message","error"]),e(A).formMode.isShow()?(s(),N(X,{key:0},{default:n(()=>[l(Y,{modelValue:F.value,"onUpdate:modelValue":o[10]||(o[10]=t=>F.value=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:n(()=>[l(P,{name:"contact",label:"Contact"}),l(P,{name:"organization",label:"Organization"}),l(P,{name:"note",label:"Notes"})]),_:1},8,["modelValue"]),l(K),l(Z,{modelValue:F.value,"onUpdate:modelValue":o[15]||(o[15]=t=>F.value=t),animated:""},{default:n(()=>[l(q,{name:"contact"},{default:n(()=>{var t,y;return[e(f).loading.value?(s(),u("div",te,[l(R,{showing:e(f).loading.value,color:"primary"},null,8,["showing"])])):(s(),u("div",re,[l(c,{modelValue:e(f).record.value.name,"onUpdate:modelValue":o[11]||(o[11]=d=>e(f).record.value.name=d),filled:"",label:"Name",outlined:"","hide-bottom-space":"",dense:"",readonly:""},null,8,["modelValue"]),(s(!0),u(C,null,U((t=e(f).record.value)==null?void 0:t.emails,(d,b)=>(s(),u("div",{key:b},[l(c,{readonly:"",type:"email",dense:"",filled:"","model-value":d,label:"Email"},null,8,["model-value"])]))),128)),(s(!0),u(C,null,U((y=e(f).record.value)==null?void 0:y.phones,(d,b)=>(s(),u("div",{key:b},[l(c,{readonly:"",dense:"",filled:"","model-value":d,label:"Phone"},null,8,["model-value"])]))),128)),l(T,{label:"Edit",color:"primary",size:"md",onClick:o[12]||(o[12]=d=>e(p).actions.form.edit(e(f).record.value))})]))]}),_:1}),l(q,{name:"organization"},{default:n(()=>{var t,y;return[e(v).loading.value?(s(),u("div",ne,[l(R,{showing:e(v).loading.value,color:"primary"},null,8,["showing"])])):(s(),u("div",ie,[l(c,{modelValue:e(v).record.value.name,"onUpdate:modelValue":o[13]||(o[13]=d=>e(v).record.value.name=d),filled:"",label:"Name",outlined:"","hide-bottom-space":"",dense:"",readonly:""},null,8,["modelValue"]),(s(!0),u(C,null,U((t=e(v).record.value)==null?void 0:t.emails,(d,b)=>(s(),u("div",{key:b},[l(c,{readonly:"",type:"email",dense:"",filled:"","model-value":d,label:"Email"},null,8,["model-value"])]))),128)),(s(!0),u(C,null,U((y=e(v).record.value)==null?void 0:y.phones,(d,b)=>(s(),u("div",{key:b},[l(c,{readonly:"",dense:"",filled:"","model-value":d,label:"Phone"},null,8,["model-value"])]))),128)),l(T,{label:"Edit",color:"primary",size:"md",onClick:o[14]||(o[14]=d=>e(m).actions.form.edit(e(v).record.value))})]))]}),_:1}),l(q,{name:"note"},{default:n(()=>[l(ee,{id:e(r).id,type:"opportunities"},null,8,["id"])]),_:1})]),_:1},8,["modelValue"])]),_:1})):O("",!0)]),_:1}),l(L,{modelValue:e(m).formShow.value,"onUpdate:modelValue":o[16]||(o[16]=t=>e(m).formShow.value=t),mode:e(m).formMode.value,title:"Organization",loading:e(m).formProcessing.value,onOnCreate:o[17]||(o[17]=t=>e(m).onCreate({})),onOnUpdate:o[18]||(o[18]=t=>e(m).onUpdate({}))},{form:n(()=>[l(le,{formHooks:e(m)},null,8,["formHooks"])]),_:1},8,["modelValue","mode","loading"]),l(L,{modelValue:e(p).formShow.value,"onUpdate:modelValue":o[19]||(o[19]=t=>e(p).formShow.value=t),mode:e(p).formMode.value,title:e($).title,loading:e(p).formProcessing.value,onOnCreate:o[20]||(o[20]=t=>e(p).onCreate({})),onOnUpdate:o[21]||(o[21]=t=>e(p).onUpdate({}))},{form:n(()=>[l(ae,{formHooks:e(p)},null,8,["formHooks"])]),_:1},8,["modelValue","mode","title","loading"])]))}};export{Ue as default};
