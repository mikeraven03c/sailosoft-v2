import{bp as O,r as Z,w as X,t as Y,V as s,Y as u,$ as l,X as n,a7 as e,W as T,S as A,bm as M,a0 as P,a1 as z,aT as c,aZ as G,Q as J,Z as C,_ as Q,a4 as E}from"./index.d510ed45.js";import{Q as U,b as _}from"./QMenu.e66367a1.js";import{Q as V}from"./QSelect.3cee18ec.js";import{c as K,Q as w}from"./QTabs.bab11733.js";import{a as I,Q as B,_ as R}from"./FormModal.bf50ce24.js";import{Q as h,a as H}from"./QPopupProxy.48b18346.js";import{Q as ee}from"./QForm.75657b46.js";import{s as S}from"./selectRenderHooks.dfbe8647.js";import{H as L}from"./HandleFormShow.d5e34568.js";import{_ as oe}from"./OrganizationFormTemplate.13555752.js";import le from"./ContactFormTemplate.997efc3d.js";import{_ as ae,a as re}from"./TaskIndexTemplate.2d015257.js";import{_ as te}from"./TagComponent.ebd5106e.js";import"./QResizeObserver.076847df.js";import"./QSpace.6f68aa3e.js";import"./QTooltip.c04ed348.js";import"./ResourceForm.affcb3a8.js";import"./QList.74fe262e.js";import"./QToolbar.dc0fe3a3.js";const ne={key:0,class:"q-ma-xl"},ie={key:1,class:"q-gutter-md q-mt-xs"},se={key:0,class:"q-ma-xl"},de={key:1,class:"q-gutter-md q-mt-xs"},Se={__name:"DealsFormTemplate",props:{formHooks:Object},setup(j){const{formHooks:D}=j,{formData:t,formReadonly:g,formError:i,hooksCycle:W,actions:q}=D,$=S({url:"custom-apps/contacts",map:a=>({label:a.name,value:a.id})}),x=S({url:"custom-apps/organizations",map:a=>({label:a.name,value:a.id})}),m=I({title:"Organization",url:"custom-apps/organizations"});m.hooksCycle.afterCreate=a=>{t.value.organization={label:a.name,value:a.id}},m.hooksCycle.afterUpdate=a=>{v.record.value=a};const p=I({title:O.title,url:O.url});p.hooksCycle.afterCreate=a=>{t.value.contact={label:a.name,value:a.id}},p.hooksCycle.afterUpdate=a=>{f.record.value=a};const N=S({url:"custom-apps/pipelines",map:a=>({label:a.name,value:a.id})}),k=S({url:"custom-apps/pipeline-stages",map:a=>({label:a.name,value:a.id})});k.hooks.resolvedParams=a=>(a.params["filter[pipeline_id]"]=t.value.pipeline.value,a);const f=L({url:"custom-apps/contacts"}),v=L({url:"custom-apps/organizations"});W.afterResolve=a=>(a.is_lead=!1,a.contact&&(a.contact_id=a.contact.value),a.organization&&(a.organization_id=a.organization.value),a);const F=Z("contact");return X(()=>t.value.pipeline,(a,o)=>{a&&(t.value.pipeline_stage=null)}),Y(()=>{var a,o;q.formMode.isShow()&&(t.value.contact&&f.fetch((a=t.value.contact_id)!=null?a:t.value.contact.value),t.value.organization&&v.fetch((o=t.value.organization_id)!=null?o:t.value.organization.value))}),(a,o)=>(s(),u("div",null,[l(ee,{class:"q-gutter-md q-mt-xs"},{default:n(()=>[l(V,{filled:"","use-input":"",dense:"","hide-bottom-space":"",modelValue:e(t).contact,"onUpdate:modelValue":o[1]||(o[1]=r=>e(t).contact=r),"error-message":e(i).contact,error:e(i).contact!==void 0,label:"Contact","input-debounce":"1000",options:e($).options.value,onFilter:e($).filterFn,onFilterAbort:e($).abortFilterFn,readonly:e(g),clearable:""},{append:n(()=>[e(t).contact?P("",!0):(s(),T(A,{key:0,class:"cursor-pointer",name:"add_circle",onClick:o[0]||(o[0]=M(r=>e(p).actions.form.create(),["stop","prevent"]))}))]),"no-option":n(()=>[l(U,null,{default:n(()=>[l(_,{class:"text-grey"},{default:n(()=>[z(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","error-message","error","options","onFilter","onFilterAbort","readonly"]),l(V,{filled:"","use-input":"",dense:"","hide-bottom-space":"",modelValue:e(t).organization,"onUpdate:modelValue":o[3]||(o[3]=r=>e(t).organization=r),"error-message":e(i).organization,error:e(i).organization!==void 0,label:"Organization","input-debounce":"1000",options:e(x).options.value,onFilter:e(x).filterFn,onFilterAbort:e(x).abortFilterFn,readonly:e(g),clearable:""},{append:n(()=>[e(t).organization?P("",!0):(s(),T(A,{key:0,class:"cursor-pointer",name:"add_circle",onClick:o[2]||(o[2]=M(r=>e(m).actions.form.create(),["stop","prevent"]))}))]),"no-option":n(()=>[l(U,null,{default:n(()=>[l(_,{class:"text-grey"},{default:n(()=>[z(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","error-message","error","options","onFilter","onFilterAbort","readonly"]),l(c,{modelValue:e(t).title,"onUpdate:modelValue":o[4]||(o[4]=r=>e(t).title=r),filled:"",label:"Title *",outlined:"","hide-bottom-space":"",dense:"",readonly:e(g),"error-message":e(i).title,error:e(i).title!==void 0},null,8,["modelValue","readonly","error-message","error"]),l(c,{modelValue:e(t).value,"onUpdate:modelValue":o[5]||(o[5]=r=>e(t).value=r),filled:"",label:"Value",outlined:"","hide-bottom-space":"",dense:"",readonly:e(g),"error-message":e(i).value,error:e(i).value!==void 0},null,8,["modelValue","readonly","error-message","error"]),l(V,{filled:"","use-input":"",dense:"","hide-bottom-space":"",modelValue:e(t).pipeline,"onUpdate:modelValue":o[6]||(o[6]=r=>e(t).pipeline=r),"error-message":e(i).pipeline,error:e(i).pipeline!==void 0,label:"Pipelines","input-debounce":"1000",options:e(N).options.value,onFilter:e(N).filterFn,onFilterAbort:e(N).abortFilterFn,readonly:e(g)},{"no-option":n(()=>[l(U,null,{default:n(()=>[l(_,{class:"text-grey"},{default:n(()=>[z(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","error-message","error","options","onFilter","onFilterAbort","readonly"]),l(V,{filled:"","use-input":"",dense:"","hide-bottom-space":"",modelValue:e(t).pipeline_stage,"onUpdate:modelValue":o[7]||(o[7]=r=>e(t).pipeline_stage=r),"error-message":e(i).pipeline_stage,error:e(i).pipeline_stage!==void 0,label:"Pipeline Stage","input-debounce":"1000",options:e(k).options.value,onFilter:e(k).filterFn,onFilterAbort:e(k).abortFilterFn,readonly:e(g)},{"no-option":n(()=>[l(U,null,{default:n(()=>[l(_,{class:"text-grey"},{default:n(()=>[z(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","error-message","error","options","onFilter","onFilterAbort","readonly"]),l(te,{modelValue:e(t).tags,"onUpdate:modelValue":o[8]||(o[8]=r=>e(t).tags=r),modelModifiers:{value:!0},resource:"opportunities",label:"Tags",readonly:e(g),error:e(i).tags},null,8,["modelValue","readonly","error"]),l(V,{modelValue:e(t).label,"onUpdate:modelValue":o[9]||(o[9]=r=>e(t).label=r),"error-message":e(i).label,error:e(i).label!==void 0,filled:"","hide-bottom-space":"",dense:"",options:["Hot","Warm","Cold"],label:"Label"},null,8,["modelValue","error-message","error"]),l(c,{modelValue:e(t).source,"onUpdate:modelValue":o[10]||(o[10]=r=>e(t).source=r),filled:"",label:"Source",outlined:"","hide-bottom-space":"",dense:"",readonly:e(g),"error-message":e(i).source,error:e(i).source!==void 0},null,8,["modelValue","readonly","error-message","error"]),e(q).formMode.isShow()?(s(),T(G,{key:0},{default:n(()=>[l(K,{modelValue:F.value,"onUpdate:modelValue":o[11]||(o[11]=r=>F.value=r),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:n(()=>[l(w,{name:"contact",label:"Contact"}),l(w,{name:"organization",label:"Organization"}),l(w,{name:"note",label:"Notes"}),l(w,{name:"task",label:"Task"})]),_:1},8,["modelValue"]),l(J),l(h,{modelValue:F.value,"onUpdate:modelValue":o[16]||(o[16]=r=>F.value=r),animated:""},{default:n(()=>[l(H,{name:"contact"},{default:n(()=>{var r,y;return[e(f).loading.value?(s(),u("div",ne,[l(B,{showing:e(f).loading.value,color:"primary"},null,8,["showing"])])):(s(),u("div",ie,[l(c,{modelValue:e(f).record.value.name,"onUpdate:modelValue":o[12]||(o[12]=d=>e(f).record.value.name=d),filled:"",label:"Name",outlined:"","hide-bottom-space":"",dense:"",readonly:""},null,8,["modelValue"]),(s(!0),u(C,null,Q((r=e(f).record.value)==null?void 0:r.emails,(d,b)=>(s(),u("div",{key:b},[l(c,{readonly:"",type:"email",dense:"",filled:"","model-value":d,label:"Email"},null,8,["model-value"])]))),128)),(s(!0),u(C,null,Q((y=e(f).record.value)==null?void 0:y.phones,(d,b)=>(s(),u("div",{key:b},[l(c,{readonly:"",dense:"",filled:"","model-value":d,label:"Phone"},null,8,["model-value"])]))),128)),l(E,{label:"Edit",color:"primary",size:"md",onClick:o[13]||(o[13]=d=>e(p).actions.form.edit(e(f).record.value))})]))]}),_:1}),l(H,{name:"organization"},{default:n(()=>{var r,y;return[e(v).loading.value?(s(),u("div",se,[l(B,{showing:e(v).loading.value,color:"primary"},null,8,["showing"])])):(s(),u("div",de,[l(c,{modelValue:e(v).record.value.name,"onUpdate:modelValue":o[14]||(o[14]=d=>e(v).record.value.name=d),filled:"",label:"Name",outlined:"","hide-bottom-space":"",dense:"",readonly:""},null,8,["modelValue"]),(s(!0),u(C,null,Q((r=e(v).record.value)==null?void 0:r.emails,(d,b)=>(s(),u("div",{key:b},[l(c,{readonly:"",type:"email",dense:"",filled:"","model-value":d,label:"Email"},null,8,["model-value"])]))),128)),(s(!0),u(C,null,Q((y=e(v).record.value)==null?void 0:y.phones,(d,b)=>(s(),u("div",{key:b},[l(c,{readonly:"",dense:"",filled:"","model-value":d,label:"Phone"},null,8,["model-value"])]))),128)),l(E,{label:"Edit",color:"primary",size:"md",onClick:o[15]||(o[15]=d=>e(m).actions.form.edit(e(v).record.value))})]))]}),_:1}),l(H,{name:"note"},{default:n(()=>[l(ae,{id:e(t).id,type:"opportunities"},null,8,["id"])]),_:1}),l(H,{name:"task"},{default:n(()=>[l(re,{id:e(t).id,type:"opportunities"},null,8,["id"])]),_:1})]),_:1},8,["modelValue"])]),_:1})):P("",!0)]),_:1}),l(R,{modelValue:e(m).formShow.value,"onUpdate:modelValue":o[17]||(o[17]=r=>e(m).formShow.value=r),mode:e(m).formMode.value,title:"Organization",loading:e(m).formProcessing.value,onOnCreate:o[18]||(o[18]=r=>e(m).onCreate({})),onOnUpdate:o[19]||(o[19]=r=>e(m).onUpdate({}))},{form:n(()=>[l(oe,{formHooks:e(m)},null,8,["formHooks"])]),_:1},8,["modelValue","mode","loading"]),l(R,{modelValue:e(p).formShow.value,"onUpdate:modelValue":o[20]||(o[20]=r=>e(p).formShow.value=r),mode:e(p).formMode.value,title:e(O).title,loading:e(p).formProcessing.value,onOnCreate:o[21]||(o[21]=r=>e(p).onCreate({})),onOnUpdate:o[22]||(o[22]=r=>e(p).onUpdate({}))},{form:n(()=>[l(le,{formHooks:e(p)},null,8,["formHooks"])]),_:1},8,["modelValue","mode","title","loading"])]))}};export{Se as default};
