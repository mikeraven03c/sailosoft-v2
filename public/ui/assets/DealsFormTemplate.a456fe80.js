import{bo as O,r as G,w as J,G as K,a2 as s,a5 as u,a8 as l,a4 as n,ag as e,a3 as P,a1 as T,bl as M,a9 as q,aa as z,aW as c,b1 as X,$ as Y,a6 as C,a7 as Q,ad as E}from"./index.62a56d21.js";import{Q as U,b as _}from"./QMenu.1879ff20.js";import{Q as V}from"./QSelect.56e8e954.js";import{Q as Z,b as w}from"./ResourceForm.7fec25d5.js";import{a as I,Q as B,_ as R}from"./FormModal.7bac0fbd.js";import{Q as h,a as H,_ as ee,b as oe}from"./TaskIndexTemplate.0333021a.js";import{Q as le}from"./QForm.9e0a2e8b.js";import{s as S}from"./selectRenderHooks.8016e166.js";import{H as L}from"./HandleFormShow.31fa948f.js";import{_ as ae}from"./OrganizationFormTemplate.f544f6e3.js";import te from"./ContactFormTemplate.27dbaead.js";import"./QResizeObserver.ca43569d.js";import"./QSpace.c6f2a2c6.js";import"./QToolbar.cb15798e.js";const re={key:0,class:"q-ma-xl"},ne={key:1,class:"q-gutter-md q-mt-xs"},ie={key:0,class:"q-ma-xl"},se={key:1,class:"q-gutter-md q-mt-xs"},Ce={__name:"DealsFormTemplate",props:{formHooks:Object},setup(j){const{formHooks:D}=j,{formData:r,formReadonly:g,formError:i,hooksCycle:W,actions:A}=D,x=S({url:"custom-apps/contacts",map:a=>({label:a.name,value:a.id})}),$=S({url:"custom-apps/organizations",map:a=>({label:a.name,value:a.id})}),m=I({title:"Organization",url:"custom-apps/organizations"});m.hooksCycle.afterCreate=a=>{r.value.organization={label:a.name,value:a.id}},m.hooksCycle.afterUpdate=a=>{v.record.value=a};const p=I({title:O.title,url:O.url});p.hooksCycle.afterCreate=a=>{r.value.contact={label:a.name,value:a.id}},p.hooksCycle.afterUpdate=a=>{f.record.value=a};const N=S({url:"custom-apps/pipelines",map:a=>({label:a.name,value:a.id})}),k=S({url:"custom-apps/pipeline-stages",map:a=>({label:a.name,value:a.id})});k.hooks.resolvedParams=a=>(a.params["filter[pipeline_id]"]=r.value.pipeline.value,a);const f=L({url:"custom-apps/contacts"}),v=L({url:"custom-apps/organizations"});W.afterResolve=a=>(a.is_lead=!1,a.contact&&(a.contact_id=a.contact.value),a.organization&&(a.organization_id=a.organization.value),a);const F=G("contact");return J(()=>r.value.pipeline,(a,o)=>{a&&(r.value.pipeline_stage=null)}),K(()=>{var a,o;A.formMode.isShow()&&(r.value.contact&&f.fetch((a=r.value.contact_id)!=null?a:r.value.contact.value),r.value.organization&&v.fetch((o=r.value.organization_id)!=null?o:r.value.organization.value))}),(a,o)=>(s(),u("div",null,[l(le,{class:"q-gutter-md q-mt-xs"},{default:n(()=>[l(V,{filled:"","use-input":"",dense:"","hide-bottom-space":"",modelValue:e(r).contact,"onUpdate:modelValue":o[1]||(o[1]=t=>e(r).contact=t),"error-message":e(i).contact,error:e(i).contact!==void 0,label:"Contact","input-debounce":"1000",options:e(x).options.value,onFilter:e(x).filterFn,onFilterAbort:e(x).abortFilterFn,readonly:e(g),clearable:""},{append:n(()=>[e(r).contact?q("",!0):(s(),P(T,{key:0,class:"cursor-pointer",name:"add_circle",onClick:o[0]||(o[0]=M(t=>e(p).actions.form.create(),["stop","prevent"]))}))]),"no-option":n(()=>[l(U,null,{default:n(()=>[l(_,{class:"text-grey"},{default:n(()=>[z(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","error-message","error","options","onFilter","onFilterAbort","readonly"]),l(V,{filled:"","use-input":"",dense:"","hide-bottom-space":"",modelValue:e(r).organization,"onUpdate:modelValue":o[3]||(o[3]=t=>e(r).organization=t),"error-message":e(i).organization,error:e(i).organization!==void 0,label:"Organization","input-debounce":"1000",options:e($).options.value,onFilter:e($).filterFn,onFilterAbort:e($).abortFilterFn,readonly:e(g),clearable:""},{append:n(()=>[e(r).organization?q("",!0):(s(),P(T,{key:0,class:"cursor-pointer",name:"add_circle",onClick:o[2]||(o[2]=M(t=>e(m).actions.form.create(),["stop","prevent"]))}))]),"no-option":n(()=>[l(U,null,{default:n(()=>[l(_,{class:"text-grey"},{default:n(()=>[z(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","error-message","error","options","onFilter","onFilterAbort","readonly"]),l(c,{modelValue:e(r).title,"onUpdate:modelValue":o[4]||(o[4]=t=>e(r).title=t),filled:"",label:"Title *",outlined:"","hide-bottom-space":"",dense:"",readonly:e(g),"error-message":e(i).title,error:e(i).title!==void 0},null,8,["modelValue","readonly","error-message","error"]),l(c,{modelValue:e(r).value,"onUpdate:modelValue":o[5]||(o[5]=t=>e(r).value=t),filled:"",label:"Value",outlined:"","hide-bottom-space":"",dense:"",readonly:e(g),"error-message":e(i).value,error:e(i).value!==void 0},null,8,["modelValue","readonly","error-message","error"]),l(V,{filled:"","use-input":"",dense:"","hide-bottom-space":"",modelValue:e(r).pipeline,"onUpdate:modelValue":o[6]||(o[6]=t=>e(r).pipeline=t),"error-message":e(i).pipeline,error:e(i).pipeline!==void 0,label:"Pipelines","input-debounce":"1000",options:e(N).options.value,onFilter:e(N).filterFn,onFilterAbort:e(N).abortFilterFn,readonly:e(g)},{"no-option":n(()=>[l(U,null,{default:n(()=>[l(_,{class:"text-grey"},{default:n(()=>[z(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","error-message","error","options","onFilter","onFilterAbort","readonly"]),l(V,{filled:"","use-input":"",dense:"","hide-bottom-space":"",modelValue:e(r).pipeline_stage,"onUpdate:modelValue":o[7]||(o[7]=t=>e(r).pipeline_stage=t),"error-message":e(i).pipeline_stage,error:e(i).pipeline_stage!==void 0,label:"Pipeline Stage","input-debounce":"1000",options:e(k).options.value,onFilter:e(k).filterFn,onFilterAbort:e(k).abortFilterFn,readonly:e(g)},{"no-option":n(()=>[l(U,null,{default:n(()=>[l(_,{class:"text-grey"},{default:n(()=>[z(" No results ")]),_:1})]),_:1})]),_:1},8,["modelValue","error-message","error","options","onFilter","onFilterAbort","readonly"]),l(V,{modelValue:e(r).label,"onUpdate:modelValue":o[8]||(o[8]=t=>e(r).label=t),"error-message":e(i).label,error:e(i).label!==void 0,filled:"","hide-bottom-space":"",dense:"",options:["Hot","Warm","Cold"],label:"Label"},null,8,["modelValue","error-message","error"]),l(c,{modelValue:e(r).source,"onUpdate:modelValue":o[9]||(o[9]=t=>e(r).source=t),filled:"",label:"Source",outlined:"","hide-bottom-space":"",dense:"",readonly:e(g),"error-message":e(i).source,error:e(i).source!==void 0},null,8,["modelValue","readonly","error-message","error"]),e(A).formMode.isShow()?(s(),P(X,{key:0},{default:n(()=>[l(Z,{modelValue:F.value,"onUpdate:modelValue":o[10]||(o[10]=t=>F.value=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:n(()=>[l(w,{name:"contact",label:"Contact"}),l(w,{name:"organization",label:"Organization"}),l(w,{name:"note",label:"Notes"}),l(w,{name:"task",label:"Task"})]),_:1},8,["modelValue"]),l(Y),l(h,{modelValue:F.value,"onUpdate:modelValue":o[15]||(o[15]=t=>F.value=t),animated:""},{default:n(()=>[l(H,{name:"contact"},{default:n(()=>{var t,y;return[e(f).loading.value?(s(),u("div",re,[l(B,{showing:e(f).loading.value,color:"primary"},null,8,["showing"])])):(s(),u("div",ne,[l(c,{modelValue:e(f).record.value.name,"onUpdate:modelValue":o[11]||(o[11]=d=>e(f).record.value.name=d),filled:"",label:"Name",outlined:"","hide-bottom-space":"",dense:"",readonly:""},null,8,["modelValue"]),(s(!0),u(C,null,Q((t=e(f).record.value)==null?void 0:t.emails,(d,b)=>(s(),u("div",{key:b},[l(c,{readonly:"",type:"email",dense:"",filled:"","model-value":d,label:"Email"},null,8,["model-value"])]))),128)),(s(!0),u(C,null,Q((y=e(f).record.value)==null?void 0:y.phones,(d,b)=>(s(),u("div",{key:b},[l(c,{readonly:"",dense:"",filled:"","model-value":d,label:"Phone"},null,8,["model-value"])]))),128)),l(E,{label:"Edit",color:"primary",size:"md",onClick:o[12]||(o[12]=d=>e(p).actions.form.edit(e(f).record.value))})]))]}),_:1}),l(H,{name:"organization"},{default:n(()=>{var t,y;return[e(v).loading.value?(s(),u("div",ie,[l(B,{showing:e(v).loading.value,color:"primary"},null,8,["showing"])])):(s(),u("div",se,[l(c,{modelValue:e(v).record.value.name,"onUpdate:modelValue":o[13]||(o[13]=d=>e(v).record.value.name=d),filled:"",label:"Name",outlined:"","hide-bottom-space":"",dense:"",readonly:""},null,8,["modelValue"]),(s(!0),u(C,null,Q((t=e(v).record.value)==null?void 0:t.emails,(d,b)=>(s(),u("div",{key:b},[l(c,{readonly:"",type:"email",dense:"",filled:"","model-value":d,label:"Email"},null,8,["model-value"])]))),128)),(s(!0),u(C,null,Q((y=e(v).record.value)==null?void 0:y.phones,(d,b)=>(s(),u("div",{key:b},[l(c,{readonly:"",dense:"",filled:"","model-value":d,label:"Phone"},null,8,["model-value"])]))),128)),l(E,{label:"Edit",color:"primary",size:"md",onClick:o[14]||(o[14]=d=>e(m).actions.form.edit(e(v).record.value))})]))]}),_:1}),l(H,{name:"note"},{default:n(()=>[l(ee,{id:e(r).id,type:"opportunities"},null,8,["id"])]),_:1}),l(H,{name:"task"},{default:n(()=>[l(oe,{id:e(r).id,type:"opportunities"},null,8,["id"])]),_:1})]),_:1},8,["modelValue"])]),_:1})):q("",!0)]),_:1}),l(R,{modelValue:e(m).formShow.value,"onUpdate:modelValue":o[16]||(o[16]=t=>e(m).formShow.value=t),mode:e(m).formMode.value,title:"Organization",loading:e(m).formProcessing.value,onOnCreate:o[17]||(o[17]=t=>e(m).onCreate({})),onOnUpdate:o[18]||(o[18]=t=>e(m).onUpdate({}))},{form:n(()=>[l(ae,{formHooks:e(m)},null,8,["formHooks"])]),_:1},8,["modelValue","mode","loading"]),l(R,{modelValue:e(p).formShow.value,"onUpdate:modelValue":o[19]||(o[19]=t=>e(p).formShow.value=t),mode:e(p).formMode.value,title:e(O).title,loading:e(p).formProcessing.value,onOnCreate:o[20]||(o[20]=t=>e(p).onCreate({})),onOnUpdate:o[21]||(o[21]=t=>e(p).onUpdate({}))},{form:n(()=>[l(te,{formHooks:e(p)},null,8,["formHooks"])]),_:1},8,["modelValue","mode","title","loading"])]))}};export{Ce as default};
